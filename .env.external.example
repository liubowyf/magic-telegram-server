# =================================
# Magic Telegram Server 环境变量配置模板
# 作者: liubo
# 日期: 2025-08-25
# 描述: 外部MongoDB部署的环境变量配置
# =================================

# =================================
# 应用基础配置
# =================================

# 应用版本
APP_VERSION=latest

# Spring配置
SPRING_PROFILES_ACTIVE=production
SERVER_PORT=8080
APP_PORT=8080

# 时区配置
TIMEZONE=Asia/Shanghai

# =================================
# 外部MongoDB配置
# =================================

# MongoDB连接URI（推荐方式）
# 格式: mongodb://[username:password@]host1[:port1][,...hostN[:portN]][/[defaultauthdb][?options]]
MONGODB_URI=mongodb://username:password@your-mongodb-host:27017/telegram_db?authSource=admin

# 或者使用分离的配置
MONGODB_HOST=your-mongodb-host.com
MONGODB_PORT=27017
MONGODB_DATABASE=telegram_db
MONGODB_USERNAME=your_username
MONGODB_PASSWORD=your_password
MONGODB_AUTH_DATABASE=admin

# SSL/TLS配置
MONGODB_SSL_ENABLED=false
MONGODB_SSL_INVALID_HOSTNAME_ALLOWED=false

# 连接池配置
MONGODB_MAX_POOL_SIZE=100
MONGODB_MIN_POOL_SIZE=10
MONGODB_MAX_IDLE_TIME_MS=60000
MONGODB_MAX_LIFE_TIME_MS=120000
MONGODB_CONNECT_TIMEOUT_MS=10000
MONGODB_SOCKET_TIMEOUT_MS=0

# =================================
# Telegram Bot配置
# =================================

# Telegram Bot Token（必须配置）
TELEGRAM_BOT_TOKEN=your_bot_token_here

# Telegram Bot用户名
TELEGRAM_BOT_USERNAME=your_bot_username

# =================================
# JVM配置（生产环境）
# =================================

# JVM内存配置
JVM_XMS=1g
JVM_XMX=2g
JVM_MAX_RAM_PERCENTAGE=75.0

# =================================
# 日志配置
# =================================

# 日志级别（生产环境建议INFO或WARN）
LOG_LEVEL=INFO
APP_LOG_LEVEL=INFO
MONGODB_LOG_LEVEL=WARN

# =================================
# 资源限制配置（生产环境）
# =================================

# 应用资源限制
APP_MEMORY_LIMIT=4G
APP_CPU_LIMIT=2.0
APP_MEMORY_RESERVATION=2G
APP_CPU_RESERVATION=1.0

# =================================
# 监控配置
# =================================

# Actuator端点（生产环境建议限制）
ACTUATOR_ENDPOINTS=health,info,metrics
HEALTH_SHOW_DETAILS=when_authorized

# =================================
# 网络配置
# =================================

# 如果MongoDB主机需要特定IP映射
MONGODB_HOST_IP=192.168.1.100

# DNS服务器配置
DNS_SERVER_1=8.8.8.8
DNS_SERVER_2=8.8.4.4

# =================================
# 安全配置
# =================================

# 管理员配置
ADMIN_USERNAME=admin
ADMIN_PASSWORD=your_secure_admin_password_here

# JWT配置
JWT_SECRET=your_very_secure_jwt_secret_key_here
JWT_EXPIRATION=86400

# =================================
# 高可用配置
# =================================

# 健康检查配置
HEALTH_CHECK_INTERVAL=30s
HEALTH_CHECK_TIMEOUT=10s
HEALTH_CHECK_RETRIES=5
HEALTH_CHECK_START_PERIOD=90s

# =================================
# 云服务配置示例
# =================================

# MongoDB Atlas示例
# MONGODB_URI=mongodb+srv://username:password@cluster0.xxxxx.mongodb.net/telegram_db?retryWrites=true&w=majority
# MONGODB_SSL_ENABLED=true

# AWS DocumentDB示例
# MONGODB_URI=mongodb://username:password@docdb-cluster.cluster-xxxxx.us-east-1.docdb.amazonaws.com:27017/telegram_db?ssl=true&replicaSet=rs0&readPreference=secondaryPreferred&retryWrites=false
# MONGODB_SSL_ENABLED=true

# Azure Cosmos DB示例
# MONGODB_URI=mongodb://username:password@cosmosdb-account.mongo.cosmos.azure.com:10255/telegram_db?ssl=true&replicaSet=globaldb&maxIdleTimeMS=120000&appName=@cosmosdb-account@
# MONGODB_SSL_ENABLED=true

# =================================
# 其他配置
# =================================

# 文件上传配置
MAX_FILE_SIZE=10MB
MAX_REQUEST_SIZE=10MB

# 缓存配置（如果使用Redis）
REDIS_HOST=your-redis-host.com
REDIS_PORT=6379
REDIS_PASSWORD=your_redis_password
REDIS_DATABASE=0

# =================================
# 使用说明:
# 
# 1. 复制此文件为 .env:
#    cp .env.external.example .env
# 
# 2. 配置外部MongoDB连接:
#    - 方式1: 配置 MONGODB_URI（推荐）
#    - 方式2: 分别配置 MONGODB_HOST, MONGODB_PORT 等
# 
# 3. 修改必要的配置项:
#    - TELEGRAM_BOT_TOKEN: 必须配置你的Bot Token
#    - MongoDB连接信息: 根据你的MongoDB服务配置
#    - 安全相关密码: 建议使用强密码
# 
# 4. 测试MongoDB连接:
#    docker-compose -f docker-compose.external.yml --profile test up mongodb-test
# 
# 5. 启动服务:
#    docker-compose -f docker-compose.external.yml up -d
# 
# 注意: .env文件包含敏感信息，不要提交到版本控制系统
# =================================